(window.webpackJsonp=window.webpackJsonp||[]).push([[11],{FzRQ:function(e,t,n){"use strict";n.d(t,"a",function(){return o});var i=n("dpqZ"),a=n("fXoL");class o{constructor(e){this.translatePluralService=e}transform(e,t){return this.translatePluralService.getPluralText(t,e)}}o.\u0275fac=function(e){return new(e||o)(a.ic(i.a))},o.\u0275pipe=a.hc({name:"translatePlural",type:o,pure:!0})},W9Ay:function(e,t,n){"use strict";var i,a,o,c,s;n.d(t,"a",function(){return i}),n.d(t,"d",function(){return a}),n.d(t,"c",function(){return o}),n.d(t,"b",function(){return s}),function(e){e[e.Pending=0]="Pending",e[e.Denied=1]="Denied",e[e.Approved=2]="Approved"}(i||(i={})),function(e){e.WithWarning="withWarning",e.WithoutWarning="withoutWarning"}(a||(a={})),function(e){e.Cancellation="Cancellation",e.Leave="Leave"}(o||(o={})),function(e){e[e.Approval=0]="Approval",e[e.Denial=1]="Denial",e[e.Transfer=2]="Transfer",e[e.Delegation=3]="Delegation",e[e.SkippedApproval=4]="SkippedApproval"}(c||(c={})),function(e){e.None="None",e.RemoteWork="RemoteWork",e.Leave="Leave"}(s||(s={}))},lKEx:function(e,t,n){"use strict";n.d(t,"a",function(){return o});var i=n("ofXK"),a=n("fXoL");class o{}o.\u0275mod=a.gc({type:o}),o.\u0275inj=a.fc({factory:function(e){return new(e||o)},imports:[[i.c]]})},qfsU:function(e,t,n){"use strict";n.d(t,"a",function(){return ne});var i=n("S2pG"),a=n("EB94"),o=n("Bfh6"),c=n("qohl"),s=n("vkgz"),l=n("lJxs"),r=n("5+tZ"),p=n("W9Ay"),d=n("3HgX"),u=n("jwjS"),v=n("+tfn"),g=n("fXoL"),h=n("tk/3");class A{constructor(e){this.http=e}partialCancellationRequest(e,t){return this.http.post(e,{leaveIds:t})}}A.\u0275fac=function(e){return new(e||A)(g.sc(h.b))},A.\u0275prov=g.ec({token:A,factory:A.\u0275fac,providedIn:"root"});var f=n("LvDl"),m=n("hZRL"),b=n("sYmb"),C=n("3Pt+"),L=n("ofXK"),O=n("Y/4g"),_=n("FzRQ");const I=["form"];function T(e,t){if(1&e){const e=g.pc();g.oc(0,"label",18),g.oc(1,"input",19),g.vc("ngModelChange",function(t){g.Tc(e);const n=g.zc().$implicit;return g.zc().amLeave(n).selected=t}),g.nc(),g.jc(2,"span",22),g.nc()}if(2&e){const e=g.zc(),t=e.$implicit,n=e.index,i=g.zc();g.Wb(1),g.Gc("disabled",i.isCancelling)("ngModel",i.amLeave(t).selected)("name","am-"+n)}}function P(e,t){if(1&e){const e=g.pc();g.oc(0,"label",18),g.oc(1,"input",19),g.vc("ngModelChange",function(t){g.Tc(e);const n=g.zc().$implicit;return g.zc().pmLeave(n).selected=t}),g.nc(),g.jc(2,"span",23),g.nc()}if(2&e){const e=g.zc(),t=e.$implicit,n=e.index,i=g.zc();g.Wb(1),g.Gc("disabled",i.isCancelling)("ngModel",i.pmLeave(t).selected)("name","pm-"+n)}}function S(e,t){if(1&e){const e=g.pc();g.oc(0,"tr",16),g.oc(1,"td",17),g.oc(2,"label",18),g.oc(3,"input",19),g.vc("ngModelChange",function(n){g.Tc(e);const i=t.$implicit;return g.zc().selectAllDay(n,i)}),g.nc(),g.oc(4,"span",20),g.gd(5),g.Ac(6,"date"),g.nc(),g.nc(),g.nc(),g.oc(7,"td",17),g.ed(8,T,3,3,"label",21),g.nc(),g.oc(9,"td",17),g.ed(10,P,3,3,"label",21),g.nc(),g.nc()}if(2&e){const e=t.$implicit,n=t.index,i=g.zc();g.ac("is-whole",i.isAllDaySelected(e)),g.Wb(3),g.ac("is-incomplete",!i.isAllDaySelected(e)),g.Gc("disabled",i.isCancelling)("ngModel",i.isSomeHalfDaySelected(e))("name","date-"+n),g.Wb(2),g.hd(g.Cc(6,10,e.date,i.formatDate())),g.Wb(3),g.Gc("ngIf",!!i.amLeave(e)),g.Wb(2),g.Gc("ngIf",!!i.pmLeave(e))}}class M{constructor(e,t,n,i,a,o){this.authorizedActions=e,this.partialCancellationService=t,this.translateService=n,this.workflowActionsService=i,this.popupRef=a,this.localeId=o,this.days=[],this.timeBeforeRedirect=300,this.title=this.translateService.instant("Figgo.Approvals.MODAL_PARTIAL_CANCELLATION_TITLE")}ngOnInit(){this.buildDays(),this.submitPalette="error"}get selectedDaysCount(){return this.selectedLeaves.length/2}get selectedLeaves(){return this.days.map(e=>e.leaves.filter(e=>e.selected).map(e=>e.id)).reduce((e,t)=>[...e,...t])}buildLeave(e){return{date:e.key,leaves:e.values.map(e=>({isAm:e.isAm,selected:!1,id:e.id})).sort((e,t)=>e.id.localeCompare(t.id))}}formatDate(){switch(this.localeId){case"en-US":return"EEE. MMMM d";case"en-GB":case"nl-NL":return"EEE. d MMMM";default:return"EEE d MMMM"}}submit(){this.form.touched&&this.selectedDaysCount>0&&(this.isCancelling=!0,this.getCancelRequest.pipe(Object(s.a)(()=>{this.isSuccess=!0})).subscribe(()=>{setTimeout(()=>{this.popupRef.close({cancelledDays:this.selectedDaysCount})},this.timeBeforeRedirect)}))}get getCancelRequest(){return this.selectedLeaves.length===this.authorizedActions.cancelLeaves.leaves.length&&this.authorizedActions.cancel?this.workflowActionsService.cancelLeaveRequest(this.authorizedActions.cancel):this.partialCancellationService.partialCancellationRequest(this.authorizedActions.cancelLeaves.url,this.selectedLeaves)}amLeave(e){return e.leaves.find(e=>e.isAm)}pmLeave(e){return e.leaves.find(e=>!e.isAm)}selectAllDay(e,t){t.leaves.forEach(t=>t.selected=e)}isAllDaySelected(e){return e.leaves.every(e=>e.selected)}isSomeHalfDaySelected(e){return e.leaves.some(e=>e.selected)}onSubmit(){var e;null===(e=document.querySelector(".lu-modal-footer button"))||void 0===e||e.click()}cancelDialog(){this.popupRef.dismiss()}buildDays(){const e=f.groupBy(this.authorizedActions.cancelLeaves.leaves,e=>e.date);for(let t in e)this.days.push(this.buildLeave({key:t,values:e[t]}))}}M.\u0275fac=function(e){return new(e||M)(g.ic(a.b),g.ic(A),g.ic(b.d),g.ic(m.a),g.ic(a.a),g.ic(g.H))},M.\u0275cmp=g.cc({type:M,selectors:[["app-partial-cancellation-modal"]],viewQuery:function(e,t){if(1&e&&g.ad(I,!0),2&e){let e;g.Oc(e=g.wc())&&(t.form=e.first)}},decls:22,vars:18,consts:[[1,"lu-modal-header"],[1,"lu-modal-header-title"],[1,"lu-modal-header-close",3,"click"],[1,"lucca-icon"],[1,"lu-modal-content"],["translate","Figgo.Approvals.MODAL_PARTIAL_CANCELLATION_SUBTITLE"],[1,"partialCancellationWrapper","u-marginBottomSmaller"],[3,"ngSubmit"],["form","ngForm"],[1,"table","mod-hasFirstLine"],[1,"table-body"],["class","table-body-row",3,"is-whole",4,"ngFor","ngForOf"],[1,"lu-modal-footer"],[1,"u-marginReset"],["translate","Figgo.Approvals.MODAL_CONFIRMATION_PARTIAL_CANCELLATION_SUBMIT",1,"button","palette-error","u-marginLeftAuto",3,"luTooltip","luTooltipDisabled","click"],["translate","Figgo.Approvals.MODAL_CONFIRMATION_PARTIAL_CANCELLATION_CLOSE",1,"button","mod-link","u-paddingLeftSmall","u-paddingRightSmall",3,"click"],[1,"table-body-row"],[1,"table-body-row-cell"],[1,"checkbox"],["type","checkbox",1,"checkbox-input",3,"disabled","ngModel","name","ngModelChange"],[1,"checkbox-label"],["class","checkbox",4,"ngIf"],["translate","Figgo.Approvals.MODAL_PARTIAL_CANCELLATION_MORNING",1,"checkbox-label"],["translate","Figgo.Approvals.MODAL_PARTIAL_CANCELLATION_AFTERNOON",1,"checkbox-label"]],template:function(e,t){1&e&&(g.oc(0,"section",0),g.oc(1,"h3",1),g.gd(2),g.nc(),g.oc(3,"button",2),g.vc("click",function(){return t.cancelDialog()}),g.oc(4,"i",3),g.gd(5,"cross"),g.nc(),g.nc(),g.nc(),g.oc(6,"div",4),g.jc(7,"p",5),g.oc(8,"div",6),g.oc(9,"form",7,8),g.vc("ngSubmit",function(){return t.onSubmit()}),g.oc(11,"table",9),g.oc(12,"tbody",10),g.ed(13,S,11,13,"tr",11),g.nc(),g.nc(),g.nc(),g.nc(),g.nc(),g.oc(14,"section",12),g.oc(15,"p",13),g.gd(16),g.Ac(17,"number"),g.Ac(18,"translatePlural"),g.nc(),g.oc(19,"button",14),g.vc("click",function(){return t.submit()}),g.Ac(20,"translate"),g.nc(),g.oc(21,"button",15),g.vc("click",function(){return t.cancelDialog()}),g.nc(),g.nc()),2&e&&(g.Wb(2),g.hd(t.title),g.Wb(11),g.Gc("ngForOf",t.days),g.Wb(3),g.jd("",g.Cc(17,10,t.selectedDaysCount,"1.0-2")," ",g.Cc(18,13,"Figgo.Approvals.MODAL_CONFIRMATION_CANCELLATION_DAYS_SELECTED",t.selectedDaysCount),""),g.Wb(3),g.ac("is-loading",t.isCancelling&&!t.isSuccess)("is-success",t.isSuccess),g.Gc("luTooltip",g.Bc(20,16,"Figgo.Approvals.MODAL_CONFIRMATION_PARTIAL_CANCELLATION_TOOLTIP"))("luTooltipDisabled",0!==t.selectedDaysCount))},directives:[b.a,C.D,C.s,C.t,L.p,O.b,C.a,C.r,C.u,L.q],pipes:[L.f,_.a,b.c,L.e],styles:[".partialCancellationWrapper[_ngcontent-%COMP%]{max-height:13.5rem;overflow:auto}.table[_ngcontent-%COMP%]   .table-body-row.is-whole[_ngcontent-%COMP%]{background:#fff8e5}"]});var E=n("NoCg"),D=n("LRne");function y(e,t){if(1&e&&g.jc(0,"p",1),2&e){const e=g.zc();g.Gc("innerHTML",e.subtitle,g.Uc)}}class N{constructor(e,t){this.translateService=e,this.data=t,this.submitAction=this.submit,this.submitPalette="error",this.isSaving=!1,this.title=this.tradForTitle(),this.subtitle=this.tradForSubtitle(),this.submitLabel=this.tradForSubmit()}tradForTitle(){return this.translateService.instant(this.data.leaveType===o.f.RemoteWork?.5===this.data.nbLeaves?"Figgo.Approvals.PARTIAL_CANCELLATION_HALFDAY":"Figgo.Approvals.MODAL_CONFIRMATION_CANCELLATION_REMOTEWORK_TITLE":this.data.needApproval?"Figgo.Approvals.MODAL_CONFIRMATION_ASK_ABSENCES_TITLE":"Figgo.Approvals.MODAL_CONFIRMATION_CANCELLATION_LEAVE_TITLE")}tradForSubtitle(){return this.translateService.instant(this.data.leaveType===o.f.RemoteWork?.5===this.data.nbLeaves?"Figgo.Approvals.MODAL_CONFIRMATION_CANCELLATION_REMOTEWORK_HALFDAY_BODY":"Figgo.Approvals.MODAL_CONFIRMATION_CANCELLATION_REMOTEWORK_BODY":this.data.needApproval?"Figgo.Approvals.MODAL_CONFIRMATION_ASK_ABSENCES_BODY":"Figgo.Approvals.MODAL_CONFIRMATION_CANCELLATION_LEAVE_BODY")}tradForSubmit(){return this.translateService.instant(this.data.needApproval?"Figgo.Approvals.MODAL_CONFIRMATION_ASK_ABSENCES_SUBMIT":"Figgo.Approvals.MODAL_CONFIRMATION_CANCELLATION_WHOLE_SUBMIT")}submit(){return Object(D.a)(!0)}}N.\u0275fac=function(e){return new(e||N)(g.ic(b.d),g.ic(E.c))},N.\u0275cmp=g.cc({type:N,selectors:[["confirmation-cancellation-dialog"]],decls:1,vars:1,consts:[["class","dialog-description",3,"innerHTML",4,"ngIf"],[1,"dialog-description",3,"innerHTML"]],template:function(e,t){1&e&&g.ed(0,y,1,1,"p",0),2&e&&g.Gc("ngIf",!!t.subtitle)},directives:[L.q],styles:[".dialog-description[_ngcontent-%COMP%]{color:#313c5e}"]});var R=n("bNPO"),k=n("3Y7J"),x=n("dpuF"),F=n("abiy");const z=function(e){return{date:e}};function w(e,t){if(1&e&&(g.oc(0,"span",13),g.gd(1),g.Ac(2,"translate"),g.Ac(3,"displayDate"),g.nc()),2&e){const e=g.zc(2);g.Wb(1),g.id(" \xa0",g.Cc(2,1,"Figgo.Approvals.APPROVAL_EMPLOYEE_CONTRACT_END_DATE",g.Kc(6,z,g.Bc(3,4,e.expectedApprovalDetails.owner.dtContractEnd)))," ")}}const W=function(e,t,n){return{"palette-success":e,"palette-warning":t,"palette-error":n}};function G(e,t){if(1&e&&(g.oc(0,"div"),g.oc(1,"span",14),g.gd(2),g.nc(),g.nc()),2&e){const e=t.$implicit,n=g.zc(2);g.Wb(1),g.Gc("ngClass",g.Mc(2,W,e.state==n.LeavePeriodSyncState.Success,e.state==n.LeavePeriodSyncState.Pending,e.state==n.LeavePeriodSyncState.Error)),g.Wb(1),g.id(" ",e.name,"")}}function j(e,t){if(1&e&&(g.oc(0,"div",8),g.jc(1,"lu-user-picture",9),g.oc(2,"div",10),g.oc(3,"h3"),g.gd(4),g.nc(),g.ed(5,w,4,8,"span",11),g.nc(),g.ed(6,G,3,6,"div",12),g.nc()),2&e){const e=g.zc();g.Wb(1),g.Gc("user",e.expectedApprovalDetails.owner),g.Wb(3),g.hd(e.expectedApprovalDetails.owner.name),g.Wb(1),g.Gc("ngIf",e.expectedApprovalDetails.owner.dtContractEnd),g.Wb(1),g.Gc("ngForOf",e.expectedApprovalDetails.syncTags)}}function B(e,t){if(1&e&&(g.oc(0,"button",28),g.jc(1,"span",29),g.jc(2,"span",30),g.nc()),2&e){g.zc();const e=g.Pc(5),t=g.zc();g.ac("is-loading",t.isCancelling&&!t.isCancelSuccess)("is-success",t.isCancelSuccess),g.Gc("luPopover",e)}}function q(e,t){if(1&e){const e=g.pc();g.oc(0,"button",31),g.vc("click",function(){g.Tc(e);return g.zc(2).partialCancellation()}),g.jc(1,"span",32),g.nc()}if(2&e){const e=g.zc(2);g.ac("is-loading",e.isCancelling&&!e.isCancelSuccess)("is-success",e.isCancelSuccess)}}function K(e,t){if(1&e){const e=g.pc();g.oc(0,"button",31),g.vc("click",function(){g.Tc(e);return g.zc(2).cancel()}),g.jc(1,"span",33),g.nc()}if(2&e){const e=g.zc(2);g.ac("is-loading",e.isCancelling&&!e.isCancelSuccess)("is-success",e.isCancelSuccess)}}function V(e,t){if(1&e){const e=g.pc();g.oc(0,"div",34),g.vc("click",function(){g.Tc(e);return g.zc(2).partialCancellation()}),g.jc(1,"span",32),g.nc()}}function U(e,t){if(1&e){const e=g.pc();g.oc(0,"div",34),g.vc("click",function(){g.Tc(e);return g.zc(2).cancel()}),g.jc(1,"span",35),g.nc()}}function H(e,t){if(1&e){const e=g.pc();g.oc(0,"button",36),g.vc("click",function(){g.Tc(e);return g.zc(2).approve()}),g.nc()}if(2&e){const e=g.zc(2);g.ac("is-loading",e.isApproving&&!e.isApproveSuccess)("is-success",e.isApproveSuccess),g.Gc("disabled",e.isInAction)}}function Y(e,t){if(1&e){const e=g.pc();g.oc(0,"button",37),g.vc("click",function(){g.Tc(e);return g.zc(2).deny()}),g.nc()}if(2&e){const e=g.zc(2);g.Gc("disabled",e.isInAction)}}function X(e,t){if(1&e){const e=g.pc();g.oc(0,"span",38),g.oc(1,"button",39),g.vc("click",function(){g.Tc(e);return g.zc(2).cancel()}),g.nc(),g.nc()}if(2&e){const e=g.zc(2);g.Gc("luTooltip",e.cancelInfos)("luTooltipDisabled",!e.cancelInfos),g.Wb(1),g.ac("is-loading",e.isCancelling&&!e.isCancelSuccess)("is-success",e.isCancelSuccess),g.Gc("disabled",e.isInAction||!e.canCancel)("translate",e.cancellationKey)}}function $(e,t){if(1&e&&(g.oc(0,"button",40),g.jc(1,"span",41),g.jc(2,"span",42),g.nc()),2&e){g.zc();const e=g.Pc(13);g.Gc("luPopover",e)}}function Q(e,t){if(1&e){const e=g.pc();g.oc(0,"div",34),g.vc("click",function(){g.Tc(e);return g.zc(2).askMoreInfo()}),g.jc(1,"span",43),g.nc()}}function J(e,t){if(1&e){const e=g.pc();g.oc(0,"div",34),g.vc("click",function(){g.Tc(e);return g.zc(2).remind()}),g.jc(1,"span",44),g.nc()}}function Z(e,t){if(1&e){const e=g.pc();g.oc(0,"div",34),g.vc("click",function(){g.Tc(e);return g.zc(2).transfer()}),g.jc(1,"span",45),g.nc()}}function ee(e,t){if(1&e){const e=g.pc();g.oc(0,"div",34),g.vc("click",function(){g.Tc(e);return g.zc(2).cancel()}),g.jc(1,"span",46),g.nc()}if(2&e){const e=g.zc(2);g.Wb(1),g.Gc("translate",e.cancellationKey)}}function te(e,t){if(1&e){const e=g.pc();g.oc(0,"section",15),g.ed(1,B,3,5,"button",16),g.ed(2,q,2,4,"button",17),g.ed(3,K,2,4,"button",17),g.oc(4,"lu-popover",18,19),g.ed(6,V,2,0,"div",20),g.ed(7,U,2,0,"div",20),g.nc(),g.ed(8,H,1,5,"button",21),g.ed(9,Y,1,1,"button",22),g.ed(10,X,2,8,"span",23),g.ed(11,$,3,1,"button",24),g.oc(12,"lu-popover",25,26),g.ed(14,Q,2,0,"div",20),g.ed(15,J,2,0,"div",20),g.ed(16,Z,2,0,"div",20),g.ed(17,ee,2,1,"div",20),g.nc(),g.oc(18,"button",27),g.vc("click",function(){g.Tc(e);return g.zc().cancelDialog()}),g.nc(),g.nc()}if(2&e){const e=g.zc();g.Wb(1),g.Gc("ngIf",!e.canApprove&&e.displayCancel&&e.canCancelLeaves&&!e.onlyOneLeave),g.Wb(1),g.Gc("ngIf",!e.canApprove&&!e.displayCancel&&e.canCancelLeaves&&!e.onlyOneLeave),g.Wb(1),g.Gc("ngIf",e.canCancelLeaves&&e.onlyOneLeave),g.Wb(3),g.Gc("ngIf",e.canCancelLeaves),g.Wb(1),g.Gc("ngIf",!e.canApprove&&e.displayCancel),g.Wb(1),g.Gc("ngIf",e.canApprove),g.Wb(1),g.Gc("ngIf",e.canDeny),g.Wb(1),g.Gc("ngIf",!e.canApprove&&e.displayCancel&&!e.canCancelLeaves),g.Wb(1),g.Gc("ngIf",e.hasMoreOptions),g.Wb(3),g.Gc("ngIf",e.canApprove),g.Wb(1),g.Gc("ngIf",e.canRemind),g.Wb(1),g.Gc("ngIf",e.canTransfer),g.Wb(1),g.Gc("ngIf",e.canApprove&&e.canCancel)}}class ne{constructor(e,t,n,i,a,c,s,l,r){this.modal=e,this.workflowActionsService=t,this.approvalsStore=n,this.translateService=i,this.translatePluralService=a,this.popupRef=c,this.data=s,this.luModal=l,this.luPopup=r,this.class=!0,this.LeavePeriodSyncState=o.d,this.timeBeforeRedirect=300}get isInAction(){return this.isApproving||this.isCancelling}get hasPossibleActions(){return this.canApprove||this.canDeny||this.displayCancel||this.canTransfer||this.canCancelLeaves}get canApprove(){var e,t;return null!==(t=!!(null===(e=this.authorizedActions)||void 0===e?void 0:e.approval))&&void 0!==t&&t}get canDeny(){var e,t;return null!==(t=!!(null===(e=this.authorizedActions)||void 0===e?void 0:e.denial))&&void 0!==t&&t}get canRemind(){var e,t;return null!==(t=!!(null===(e=this.authorizedActions)||void 0===e?void 0:e.remindApprover))&&void 0!==t&&t}get canTransfer(){var e,t;return null!==(t=!!(null===(e=this.authorizedActions)||void 0===e?void 0:e.transfer))&&void 0!==t&&t}get canCancel(){var e,t,n;return null!==(n=null===(t=null===(e=this.authorizedActions)||void 0===e?void 0:e.cancel)||void 0===t?void 0:t.authorized)&&void 0!==n&&n}get displayCancel(){var e,t;return null!==(t=!!(null===(e=this.authorizedActions)||void 0===e?void 0:e.cancel))&&void 0!==t&&t}get cancelInfos(){var e,t,n;return null!==(n=null===(t=null===(e=this.authorizedActions)||void 0===e?void 0:e.cancel)||void 0===t?void 0:t.informations.join(" - "))&&void 0!==n?n:null}get canCancelLeaves(){var e,t;return null!==(t=!!(null===(e=this.authorizedActions)||void 0===e?void 0:e.cancelLeaves))&&void 0!==t&&t}get onlyOneLeave(){var e;return 1===(null===(e=this.authorizedActions)||void 0===e?void 0:e.cancelLeaves.leaves.length)}get cancellationKey(){return this.cancellationNeedsApproval?"Figgo.Approvals.APPROVAL_DETAILS_ASK_CANCEL":"Figgo.Approvals.APPROVAL_DETAILS_CANCEL"}get cancellationNeedsApproval(){return this.expectedApprovalDetails.state===o.c.Confirmed&&this.NeedCancellationApproval}get NeedCancellationApproval(){return this.expectedApprovalDetails.accountDistributions.map(e=>e.account).some(e=>e.needCancellationApproval)}get hasMoreOptions(){return this.canApprove||this.canTransfer||this.canApprove&&this.canCancel}get attachmentUrl(){var e;return null===(e=this.authorizedActions)||void 0===e?void 0:e.attachment}ngOnInit(){this.isLoading=!0,this.workflowActionsService.getLeavePeriodDetails(this.data.leavePeriodId).subscribe({next:([e,t])=>{this.expectedApprovalDetails=e,this.authorizedActions=t,this.isLoading=!1},error:()=>this.isLoading=!1})}approve(e=!1){this.isApproving=!0,this.workflowActionsService.approveLeaveRequest(e?this.authorizedActions.forceApproval:this.authorizedActions.approval).pipe(Object(s.a)(()=>{this.isApproveSuccess=!0,this.approvalsStore.leaveRequestsToApproveChange.next()}),Object(l.a)(()=>({isPeriodCancelled:this.expectedApprovalDetails.state===o.c.PendingCancellation}))).subscribe(e=>this.afterSubmit(e),t=>{this.isApproving=!1,409===t.status&&!e&&this.authorizedActions.forceApproval?this.luModal.open(v.a,t).onClose.subscribe(()=>this.approve(!0)):this.luModal.open(u.a,t)})}askMoreInfo(){this.submit(this.modal.open(c.a,this.authorizedActions.askMoreInfo).onClose)}remind(){this.submit(this.modal.open(c.c,this.authorizedActions.remindApprover).onClose)}deny(){this.authorizedActions.denial&&this.submit(this.modal.open(c.b,this.authorizedActions.denial).onClose.pipe(Object(s.a)(()=>{this.approvalsStore.leaveRequestsToApproveChange.next()}),Object(l.a)(()=>({isPeriodCancelled:this.expectedApprovalDetails.state===o.c.PendingApproval}))))}cancel(){console.log(this.expectedApprovalDetails.accountDistributions.reduce((e,t)=>e+t.distribution,0)),this.submit(this.modal.open(N,{leaveType:this.expectedApprovalDetails.leaveType,nbLeaves:this.expectedApprovalDetails.accountDistributions.reduce((e,t)=>e+t.distribution,0),needApproval:this.cancellationNeedsApproval},{size:"small"}).onClose.pipe(Object(r.a)(()=>this.cancelLeaveRequest())))}transfer(){this.authorizedActions.transfer&&this.submit(this.modal.open(c.d,this.authorizedActions.transfer).onClose.pipe(Object(s.a)(()=>{this.approvalsStore.leaveRequestsToApproveChange.next()})))}submit(e){e.subscribe(e=>this.afterSubmit(e),e=>{this.isApproving=!1,this.isCancelling=!1,this.luModal.open(u.a,e)})}afterSubmit(e){setTimeout(()=>{const t=Object.assign({ownerId:this.expectedApprovalDetails.owner.id},e);this.popupRef.close(t)},this.timeBeforeRedirect)}cancelDialog(){this.popupRef.dismiss()}partialCancellation(){this.submit(this.luPopup.open(M,this.authorizedActions,{size:"small"}).onClose.pipe(Object(s.a)(()=>{this.isCancelSuccess=!0}),Object(l.a)(e=>({isPeriodCancelled:!0,message:this.translatePluralService.getPluralText(e.cancelledDays,"Figgo.Approvals.HOME_FEEDBACK_LEAVES_CANCELLED")}))))}cancelLeaveRequest(){return this.workflowActionsService.cancelLeaveRequest(this.authorizedActions.cancel).pipe(Object(s.a)(()=>{this.isCancelSuccess=!0,this.approvalsStore.leaveRequestsToApproveChange.next()}),Object(l.a)(e=>e.approvalState===p.a.Approved?{isPeriodCancelled:!0,message:this.translateService.instant("Figgo.Approvals.HOME_FEEDBACK_LEAVE_REQUEST_CANCELLED")}:{isPeriodCancelled:!1,message:this.translateService.instant("Figgo.Approvals.HOME_FEEDBACK_LEAVE_REQUEST_CANCELLATION_REQUESTED",{user:e.nextApprover.name})}))}}ne.\u0275fac=function(e){return new(e||ne)(g.ic(E.d),g.ic(c.e),g.ic(d.a),g.ic(b.d),g.ic(i.b),g.ic(a.a),g.ic(a.b),g.ic(E.d),g.ic(a.c))},ne.\u0275cmp=g.cc({type:ne,selectors:[["app-leave-details-modal"]],hostVars:2,hostBindings:function(e,t){2&e&&g.ac("mod-lucca-icon",t.class)},decls:8,vars:5,consts:[[1,"lu-modal-header"],[1,"lu-modal-header-close",3,"click"],["aria-hidden","true",1,"lucca-icon","icon-cross"],["translate","Figgo.IconMask.CLOSE",1,"u-mask"],["class","leave-detail-box-header",4,"ngIf"],[1,"lu-modal-content"],[3,"expectedApprovalDetails","attachmentUrl","isLoading"],["class","lu-modal-footer",4,"ngIf"],[1,"leave-detail-box-header"],["displayFormat","FL",3,"user"],[1,"approval-detail-box-header-title"],["class","u-textSmall u-textLight u-textItalic",4,"ngIf"],[4,"ngFor","ngForOf"],[1,"u-textSmall","u-textLight","u-textItalic"],[1,"label",3,"ngClass"],[1,"lu-modal-footer"],["class","button mod-icon mod-outline palette-error u-paddingRightSmaller u-marginRightSmaller","luPopoverTrigger","click","luPopoverAlignment","right","luPopoverPosition","below",3,"luPopover","is-loading","is-success",4,"ngIf"],["class","button mod-icon mod-outline palette-error",3,"is-loading","is-success","click",4,"ngIf"],["close-on-click","true","panel-classes","figgo-app popover-menu","content-classes","mod-rounded"],["cancellationOptions",""],["class","popover-menu-item",3,"click",4,"ngIf"],["class","button palette-secondary","translate","Figgo.Approvals.APPROVAL_DETAILS_APPROVE",3,"disabled","is-loading","is-success","click",4,"ngIf"],["class","button mod-outline","translate","Figgo.Approvals.APPROVAL_DETAILS_DENY",3,"disabled","click",4,"ngIf"],[3,"luTooltip","luTooltipDisabled",4,"ngIf"],["class","actionIcon","luPopoverTrigger","click","luPopoverAlignment","right","luPopoverPosition","below",3,"luPopover",4,"ngIf"],["close-on-click","true"],["moreOptions",""],["translate","Figgo.Approvals.PARTIAL_CANCELLATION_CLOSE",1,"button","mod-link","u-paddingLeftSmall","u-paddingRightSmall",3,"click"],["luPopoverTrigger","click","luPopoverAlignment","right","luPopoverPosition","below",1,"button","mod-icon","mod-outline","palette-error","u-paddingRightSmaller","u-marginRightSmaller",3,"luPopover"],["translate","Figgo.Approvals.PARTIAL_CANCELLATION"],["aria-hidden","true",1,"button-icon","lucca-icon","icon-chevronSouth","u-marginLeftSmaller"],[1,"button","mod-icon","mod-outline","palette-error",3,"click"],["translate","Figgo.Approvals.PARTIAL_CANCELLATION_PART_PERIOD"],["translate","Figgo.Approvals.PARTIAL_CANCELLATION_HALFDAY"],[1,"popover-menu-item",3,"click"],["translate","Figgo.Approvals.PARTIAL_CANCELLATION_WHOLE_PERIOD"],["translate","Figgo.Approvals.APPROVAL_DETAILS_APPROVE",1,"button","palette-secondary",3,"disabled","click"],["translate","Figgo.Approvals.APPROVAL_DETAILS_DENY",1,"button","mod-outline",3,"disabled","click"],[3,"luTooltip","luTooltipDisabled"],[1,"button","palette-error","mod-outline",3,"disabled","translate","click"],["luPopoverTrigger","click","luPopoverAlignment","right","luPopoverPosition","below",1,"actionIcon",3,"luPopover"],["aria-hidden","true",1,"lucca-icon","icon-ellipsis"],["translate","Figgo.IconMask.OPTIONS",1,"u-mask"],["translate","Figgo.Approvals.APPROVAL_DETAILS_ASK_MORE_INFORMATIONS"],["translate","Figgo.Approvals.APPROVAL_DETAILS_REMIND"],["translate","Figgo.Approvals.APPROVAL_DETAILS_TRANSFER"],[3,"translate"]],template:function(e,t){1&e&&(g.oc(0,"section",0),g.oc(1,"button",1),g.vc("click",function(){return t.cancelDialog()}),g.jc(2,"span",2),g.jc(3,"span",3),g.nc(),g.ed(4,j,7,4,"div",4),g.nc(),g.oc(5,"div",5),g.jc(6,"app-leave-period-details-content",6),g.nc(),g.ed(7,te,19,13,"section",7)),2&e&&(g.Wb(4),g.Gc("ngIf",!t.isLoading&&t.expectedApprovalDetails),g.Wb(2),g.Gc("expectedApprovalDetails",t.expectedApprovalDetails)("attachmentUrl",t.attachmentUrl)("isLoading",t.isLoading),g.Wb(1),g.Gc("ngIf",t.hasPossibleActions))},directives:[b.a,L.q,R.a,k.d,L.p,L.o,x.d,x.f,O.b],pipes:[b.c,F.a],styles:["@-webkit-keyframes rotating{0%{transform:rotate(0deg)}to{transform:rotate(1turn)}}@keyframes rotating{0%{transform:rotate(0deg)}to{transform:rotate(1turn)}}@-webkit-keyframes loadingGradientKeyframes{0%{background-position:100% 0}to{background-position:-100% 0}}@keyframes loadingGradientKeyframes{0%{background-position:100% 0}to{background-position:-100% 0}}@media not all and (min-width:62em){[_nghost-%COMP%]{display:flex;flex-direction:column;min-height:calc(100vh - 50px - 3.5rem)}}.approval-detail-box[_ngcontent-%COMP%]{flex-grow:1}.approval-detail-link[_ngcontent-%COMP%]{display:flex}@media (min-width:62em){.approval-detail-link[_ngcontent-%COMP%]{display:none}}.approval-detail-link-button[_ngcontent-%COMP%]{display:flex;align-items:center;font-weight:400}.approval-detail-box.mod-notFound[_ngcontent-%COMP%]{background:#f7f9fd}@media (min-width:62em){.approval-detail-box[_ngcontent-%COMP%]{max-width:40.5rem;margin:0 auto;min-height:40rem}}@media screen and (min-width:1921px){.approval-detail-box[_ngcontent-%COMP%]{margin:0 3rem}}lu-user-picture[_ngcontent-%COMP%]{margin-bottom:0}@media (min-width:62em){lu-user-picture[_ngcontent-%COMP%]{margin-bottom:.5rem}}.approval-detail-box-header[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap;align-items:center;margin-bottom:1rem}.approval-detail-box-header-title[_ngcontent-%COMP%]{margin:0 auto 0 .5rem}.approval-detail-box-header-title[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{display:inline-block}.approval-detail-box-header-title[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{white-space:nowrap}.approval-detail-box-header-actionsWrapper[_ngcontent-%COMP%]{display:flex;align-items:center}@media not all and (min-width:62em){.approval-detail-box-header-actionsWrapper[_ngcontent-%COMP%]{position:fixed;bottom:0;left:15rem;right:0;z-index:1;justify-content:center;padding:.5rem 1rem;background:#fff;box-shadow:0 14px 28px rgba(130,141,185,.2),0 10px 10px rgba(130,141,185,.4)}}@media not all and (min-width:48em){.approval-detail-box-header-actionsWrapper[_ngcontent-%COMP%]{left:0}}.approval-detail-showMore[_ngcontent-%COMP%]{color:#7072d2;display:inline-block;margin-top:.5rem;cursor:pointer}.approval-detail-showMore[_ngcontent-%COMP%]:hover{color:#7a7de8}.approval-detail-showMore[_ngcontent-%COMP%]   .lucca-icon[_ngcontent-%COMP%]{font-size:.6rem;margin-left:.2rem}@media not all and (min-width:62em){.approval-detail-box-header-title-details[_ngcontent-%COMP%]{display:none}}","[_nghost-%COMP%]{display:flex;flex-direction:column;overflow:hidden;max-height:90vh}@media (-ms-high-contrast:none),screen and (-ms-high-contrast:active){[_nghost-%COMP%]{height:90vh}}.leave-detail-box-header[_ngcontent-%COMP%]{display:flex;align-items:center}.leave-detail-box-header-title[_ngcontent-%COMP%]{margin:0 auto 0 .5rem}.leave-detail-box-header-title[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{display:inline-block}.leave-detail-box-header-title[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{white-space:nowrap}.button-icon.icon-chevronSouth[_ngcontent-%COMP%]{font-size:1.25rem;position:relative;top:2px}"]})},u3UV:function(e,t,n){"use strict";n.d(t,"a",function(){return o});var i=n("fXoL"),a=n("jhN1");class o{constructor(e){this.sanitizer=e}transform(e){return this.sanitizer.bypassSecurityTrustResourceUrl(e)}}o.\u0275fac=function(e){return new(e||o)(i.ic(a.b))},o.\u0275pipe=i.hc({name:"safeUrl",type:o,pure:!0})}}]);